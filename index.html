<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>AksharaNama Pro ‚Äì Privacy-First Designer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Telugu:wght@400;700&family=Ramabhadra&family=Gidugu&family=Mandali&family=NTR&family=RaviPrakash&family=Tenali+Ramakrishna&family=Timmana&family=Chathura:wght@400;700&family=Ramaraja&family=Ponnala&family=Sree+Krushnadevaraya&family=Playfair+Display:wght@700&family=Merriweather:wght@700&family=Lora:wght@700&family=Roboto:wght@400;700&family=Noto+Sans+Devanagari:wght@400;700&family=Tiro+Devanagari+Sanskrit&family=Hind:wght@400;700&family=Poppins:wght@400;700&display=swap" rel="stylesheet">

<style>
  :root { --primary: #0066ff; --bg: #f0f4f8; --card: #ffffff; --highlight: #fff3cd; }
  *{box-sizing:border-box; transition: all 0.2s ease;}
  body{
    margin:0; font-family: 'Poppins', system-ui, sans-serif;
    background: var(--bg); display: flex; flex-direction: column; align-items: center; padding: 15px;
  }
  .app-container { width: 100%; max-width: 500px; display: flex; flex-direction: column; gap: 12px; }
  header { text-align: center; display: flex; justify-content: space-between; align-items: center; width: 100%; margin-bottom: 5px; }
  header h1 { margin: 0; font-size: 20px; color: #1a1a1a; font-weight: 700; }
  .help-trigger { background: #000; color: #fff; border-radius: 50%; width: 30px; height: 30px; border: none; cursor: pointer; font-weight: bold; }
  .lang-header { background: var(--highlight); border: 2px solid #ffc107; padding: 15px; border-radius: 15px; display: flex; flex-direction: column; gap: 8px; }
  .info-box { background: #eef4ff; border-left: 5px solid var(--primary); padding: 15px; border-radius: 12px; font-size: 14px; color: #334e81; line-height: 1.6; }
  .preview-card { background: var(--card); padding: 15px; border-radius: 24px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); display: flex; flex-direction: column; align-items: center; }
  .preview-wrapper { width: 250px; height: 250px; border-radius: 50%; background: #e0e0e0; border: 4px solid #fff; box-shadow: 0 8px 20px rgba(0,0,0,0.1); overflow: hidden; position: relative; }
  .controls-grid { background: var(--card); padding: 20px; border-radius: 24px; display: grid; grid-template-columns: 1fr 1fr; gap: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); }
  .control-group { display: flex; flex-direction: column; gap: 4px; }
  .full-width { grid-column: span 2; }
  label { font-size: 12px; font-weight: 700; color: #555; text-transform: uppercase; }
  input[type="text"], select, input[type="file"] { padding: 12px; border: 1.5px solid #ddd; border-radius: 10px; font-size: 15px; background: #fafafa; width: 100%; }
  .btn-group { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; }
  button { padding: 16px; border-radius: 12px; border: none; font-weight: 700; cursor: pointer; font-size: 16px; }
  .btn-main { background: #28a745; color: white; }
  .btn-sec { background: #f0f0f0; color: #555; }
  footer { margin-top: 20px; text-align: center; padding: 15px; color: #666; font-size: 13px; line-height: 1.5; }
  #canvas { display: none; }
</style>
</head>
<body>

<div class="app-container">
  <header>
    <h1>AksharaNama Pro</h1>
    <button class="help-trigger" onclick="toggleHelp()">?</button>
  </header>

  <div class="lang-header">
    <label>üåê Choose Language / ‡∞≠‡∞æ‡∞∑‡∞®‡±Å ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø</label>
    <select id="lang" onchange="loadFonts()">
      <option value="te">Telugu (‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å)</option>
      <option value="hi">Hindi (‡§π‡§ø‡§®‡•ç‡§¶‡•Ä)</option>
      <option value="en">English</option>
    </select>
  </div>

  <div class="info-box" id="helpBox"></div>

  <div class="preview-card">
    <div class="preview-wrapper">
      <canvas id="pCanvas" width="260" height="260"></canvas>
    </div>
    <div class="control-group full-width" style="margin-top:15px; width: 100%;">
        <label id="lblZoom">üîç Zoom (‡∞ú‡±Ç‡∞Æ‡±ç)</label>
        <input type="range" id="imgZoom" min="1" max="3" step="0.05" value="1">
    </div>
  </div>

  <div class="controls-grid">
    <div class="control-group full-width">
      <label id="lblPhoto">1. üì∏ Pick Photo (‡∞´‡±ã‡∞ü‡±ã)</label>
      <input type="file" id="imgInput" accept="image/*">
    </div>

    <div class="control-group full-width">
      <label id="lblName">2. ‚úçÔ∏è Your Name (‡∞Æ‡±Ä ‡∞™‡±á‡∞∞‡±Å)</label>
      <input type="text" id="nameInput" placeholder="‡∞™‡±á‡∞∞‡±Å ‡∞∞‡∞æ‡∞Ø‡∞Ç‡∞°‡∞ø" value="‡∞™‡±á‡∞∞‡±Å">
    </div>

    <div class="control-group">
      <label id="lblFont">Style (‡∞∏‡±ç‡∞ü‡±à‡∞≤‡±ç)</label>
      <select id="fontSelect"></select>
    </div>

    <div class="control-group">
        <label id="lblPos">Position (‡∞∏‡±ç‡∞•‡∞æ‡∞®‡∞Ç)</label>
        <select id="pos">
          <option value="bottom">Bottom Curve</option>
          <option value="top">Top Curve</option>
          <option value="center" selected>Center</option>
        </select>
    </div>

    <div class="control-group">
      <label id="lblTxtColor">Text Color</label>
      <input type="color" id="textColor" value="#ffffff">
    </div>

    <div class="control-group">
      <label id="lblBorder">Border Color</label>
      <input type="color" id="borderColor" value="#0066ff">
    </div>

    <input type="hidden" id="fontWeight" value="bold">
    <input type="hidden" id="borderSize" value="12">
    <input type="hidden" id="fSize" value="65">

    <div class="btn-group full-width">
      <button class="btn-sec" onclick="location.reload()">Reset</button>
      <button id="dlBtn" class="btn-main">‚úÖ Download</button>
    </div>
  </div>

  <footer>
    <p>¬© 2026 Sandeep Miriyala ‚Äî Yuktishala AI</p>
    <p>üîí Privacy First Priority</p>
    <p id="currentDateTime" style="font-weight: bold; color: #444;"></p>
  </footer>
</div>

<canvas id="canvas" width="1080" height="1080"></canvas>

<script>
const fontMap = {
  te: ["Noto Sans Telugu", "Ramabhadra", "Gidugu", "Mandali", "NTR", "RaviPrakash", "Tenali Ramakrishna", "Timmana", "Chathura", "Ramaraja", "Ponnala", "Sree Krushnadevaraya"],
  en: ["Poppins", "Roboto", "Playfair Display", "Merriweather", "Lora", "Arial"],
  hi: ["Noto Sans Devanagari", "Tiro Devanagari Sanskrit", "Hind"]
};

const translations = {
  te: {
    guide: "<strong>üöÄ ‡∞∏‡±Å‡∞≤‡∞≠‡∞Æ‡±à‡∞® ‡∞∏‡±ç‡∞ü‡±Ü‡∞™‡±ç‡∞∏‡±ç:</strong><ol><li><b>‡∞´‡±ã‡∞ü‡±ã</b> ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø.</li><li>‡∞Æ‡±Å‡∞ñ‡∞æ‡∞®‡±ç‡∞®‡∞ø ‡∞Æ‡∞ß‡±ç‡∞Ø‡∞≤‡±ã‡∞ï‡∞ø <b>Zoom</b> ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø.</li><li>‡∞Æ‡±Ä <b>‡∞™‡±á‡∞∞‡±Å</b> ‡∞∞‡∞æ‡∞Ø‡∞Ç‡∞°‡∞ø.</li><li><b>Download</b> ‡∞®‡±ä‡∞ï‡±ç‡∞ï‡∞Ç‡∞°‡∞ø.</li></ol>",
    lblPhoto: "1. üì∏ ‡∞´‡±ã‡∞ü‡±ã ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø", lblName: "2. ‚úçÔ∏è ‡∞Æ‡±Ä ‡∞™‡±á‡∞∞‡±Å ‡∞∞‡∞æ‡∞Ø‡∞Ç‡∞°‡∞ø", lblZoom: "üîç ‡∞ú‡±Ç‡∞Æ‡±ç ‡∞Ö‡∞°‡±ç‡∞ú‡∞∏‡±ç‡∞ü‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø",
    lblFont: "‡∞Ö‡∞ï‡±ç‡∞∑‡∞∞‡∞æ‡∞≤ ‡∞∏‡±ç‡∞ü‡±à‡∞≤‡±ç", lblPos: "‡∞™‡±á‡∞∞‡±Å ‡∞é‡∞ï‡±ç‡∞ï‡∞° ‡∞â‡∞Ç‡∞°‡∞æ‡∞≤‡∞ø?", lblTxtColor: "‡∞Ö‡∞ï‡±ç‡∞∑‡∞∞‡∞æ‡∞≤ ‡∞∞‡∞Ç‡∞ó‡±Å", lblBorder: "‡∞¨‡∞æ‡∞∞‡±ç‡∞°‡∞∞‡±ç ‡∞∞‡∞Ç‡∞ó‡±Å"
  },
  hi: {
    guide: "<strong>üöÄ ‡§Ü‡§∏‡§æ‡§® ‡§∏‡•ç‡§ü‡•á‡§™‡•ç‡§∏:</strong><ol><li><b>Photo</b> ‡§ö‡•Å‡§®‡•á‡§Ç‡•§</li><li>‡§ö‡•á‡§π‡§∞‡•á ‡§ï‡•ã ‡§∏‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è <b>Zoom</b> ‡§ï‡§∞‡•á‡§Ç‡•§</li><li>‡§Ö‡§™‡§®‡§æ <b>‡§®‡§æ‡§Æ</b> ‡§≤‡§ø‡§ñ‡•á‡§Ç‡•§</li><li><b>Download</b> ‡§ï‡§∞‡•á‡§Ç‡•§</li></ol>",
    lblPhoto: "1. üì∏ ‡§´‡•ã‡§ü‡•ã ‡§ö‡•Å‡§®‡•á‡§Ç", lblName: "2. ‚úçÔ∏è ‡§Ö‡§™‡§®‡§æ ‡§®‡§æ‡§Æ ‡§≤‡§ø‡§ñ‡•á‡§Ç", lblZoom: "üîç ‡§ú‡§º‡•Ç‡§Æ ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç",
    lblFont: "‡§≤‡§ø‡§ñ‡§®‡•á ‡§ï‡§æ ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤", lblPos: "‡§®‡§æ‡§Æ ‡§ï‡§π‡§æ‡§Å ‡§∞‡§ñ‡•á‡§Ç?", lblTxtColor: "‡§®‡§æ‡§Æ ‡§ï‡§æ ‡§∞‡§Ç‡§ó", lblBorder: "‡§¨‡•â‡§∞‡•ç‡§°‡§∞ ‡§ï‡§æ ‡§∞‡§Ç‡§ó"
  },
  en: {
    guide: "<strong>üöÄ Easy Steps:</strong><ol><li>Click <b>Pick Photo</b>.</li><li>Use <b>Zoom</b> to center face.</li><li>Type your <b>Name</b>.</li><li>Click <b>Download</b>.</li></ol>",
    lblPhoto: "1. üì∏ Pick Photo", lblName: "2. ‚úçÔ∏è Your Name", lblZoom: "üîç Image Zoom",
    lblFont: "Font Style", lblPos: "Text Position", lblTxtColor: "Text Color", lblBorder: "Border Color"
  }
};

const el = (id) => document.getElementById(id);
const canvas = el('canvas'), ctx = canvas.getContext('2d');
const pCanvas = el('pCanvas'), pctx = pCanvas.getContext('2d');
let userImg = null;

function loadFonts() {
  const selectedLang = el('lang').value;
  const sel = el('fontSelect');
  sel.innerHTML = "";
  fontMap[selectedLang].forEach(f => {
    const o = document.createElement("option");
    o.value = f; o.textContent = f;
    sel.appendChild(o);
  });

  const langData = translations[selectedLang];
  el('helpBox').innerHTML = langData.guide;
  el('lblPhoto').textContent = langData.lblPhoto;
  el('lblName').textContent = langData.lblName;
  el('lblZoom').textContent = langData.lblZoom;
  el('lblFont').textContent = langData.lblFont;
  el('lblPos').textContent = langData.lblPos;
  el('lblTxtColor').textContent = langData.lblTxtColor;
  el('lblBorder').textContent = langData.lblBorder;

  // Wait for fonts to load before drawing
  document.fonts.ready.then(() => { draw(); });
}

function updateFooter() {
    const now = new Date();
    const formattedDate = now.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
    el('currentDateTime').textContent = formattedDate;
}

window.onload = () => { updateFooter(); loadFonts(); };

function toggleHelp() {
  const box = el('helpBox');
  box.style.display = box.style.display === 'none' ? 'block' : 'none';
}

el('imgInput').onchange = (e) => {
    const reader = new FileReader();
    reader.onload = (event) => {
        userImg = new Image();
        userImg.onload = draw;
        userImg.src = event.target.result;
    };
    if(e.target.files[0]) reader.readAsDataURL(e.target.files[0]);
};

function drawCurved(context, text, cx, cy, radius, startAngle, fSize, font, weight) {
    if (!text) return;
    context.font = `${weight} ${fSize}px "${font}"`;
    const chars = text.split("");
    const totalWidth = context.measureText(text).width;
    const angularWidth = totalWidth / radius;
    let currentAngle = startAngle - (angularWidth / 2);

    chars.forEach(char => {
        const w = context.measureText(char).width;
        context.save();
        context.translate(cx, cy);
        context.rotate(currentAngle + (w / (2 * radius)));
        context.fillText(char, 0, -radius);
        context.restore();
        currentAngle += w / radius;
    });
}

function draw() {
    [ {c:ctx, s:1080}, {c:pctx, s:260} ].forEach(canv => {
        const c = canv.c;
        const scale = canv.s / 1080;
        const mid = canv.s / 2;
        const zoom = parseFloat(el('imgZoom').value);

        c.clearRect(0,0,canv.s,canv.s);
        const bSize = parseInt(el('borderSize').value) * scale * 2;
        c.fillStyle = el('borderColor').value;
        c.beginPath(); c.arc(mid, mid, mid, 0, Math.PI*2); c.fill();

        c.save();
        c.beginPath(); c.arc(mid, mid, mid - bSize, 0, Math.PI*2); c.clip();
        
        if (userImg) {
            const min = Math.min(userImg.width, userImg.height);
            const drawSize = canv.s * zoom;
            const offset = (drawSize - canv.s) / 2;
            c.drawImage(userImg, (userImg.width-min)/2, (userImg.height-min)/2, min, min, -offset, -offset, drawSize, drawSize);
        } else {
            c.fillStyle = "#f5f5f5"; c.fillRect(0,0,canv.s,canv.s);
            c.fillStyle = "#bbb"; c.font = `${20*scale}px sans-serif`; c.textAlign = "center";
            c.fillText("PICK PHOTO", mid, mid);
        }
        c.restore();

        c.fillStyle = el('textColor').value;
        c.shadowColor = "rgba(0,0,0,0.8)";
        c.shadowBlur = 10 * scale;
        c.textAlign = "center";
        c.textBaseline = "middle"; // Helps align Telugu characters properly

        const text = el('nameInput').value;
        const fontSize = parseInt(el('fSize').value) * scale;
        const font = el('fontSelect').value;
        const weight = el('fontWeight').value;
        const pos = el('pos').value;

        if (pos === 'bottom') {
            drawCurved(c, text, mid, mid, mid - (bSize + 65*scale), Math.PI/2, fontSize, font, weight);
        } else if (pos === 'top') {
            drawCurved(c, text, mid, mid, mid - (bSize + 65*scale), -Math.PI/2, fontSize, font, weight);
        } else {
            c.font = `${weight} ${fontSize}px "${font}"`;
            c.fillText(text, mid, mid);
        }
    });
}

['nameInput', 'textColor', 'borderColor', 'pos', 'imgZoom', 'fontSelect'].forEach(id => {
    el(id).addEventListener('input', draw);
});

el('dlBtn').onclick = () => {
    if(!userImg) return alert("Please upload a photo first!");
    const link = document.createElement('a');
    link.download = 'aksharanama_badge.png';
    link.href = canvas.toDataURL('image/png', 1.0);
    link.click();
};
</script>
</body>
</html>