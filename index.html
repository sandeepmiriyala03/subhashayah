<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>AksharaNama ‚Äì Privacy-First Image Name Tool</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="theme-color" content="#ffffff">
<meta name="description" content="Create circular image name badges. Privacy-first. No data stored.">

<link rel="manifest" href="manifest.json">

<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Telugu:wght@400;700&family=Noto+Sans+Tamil:wght@400;700&family=Noto+Sans+Kannada:wght@400;700&family=Noto+Sans+Devanagari:wght@400;700&family=Noto+Serif+Devanagari:wght@400;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,sans-serif;
  background:#f5f6f8;
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:16px;
  gap:12px;
}
header{width:100%;max-width:480px;display:flex;align-items:center;gap:10px}
header img{width:40px;height:40px;border-radius:8px}
header h1{margin:0;font-size:18px}
small{color:#555}

.controls{display:flex;flex-direction:column;gap:10px;align-items:center}
label{font-size:13px;font-weight:600;align-self:flex-start}
select,input,button{
  width:260px;padding:10px;border-radius:6px;border:1px solid #ccc;font-size:14px
}
button{background:#0066ff;color:#fff;font-weight:700;border:none;cursor:pointer}
button.secondary{background:#777}
button:disabled{opacity:.5}

.preview{
  width:260px;height:260px;border-radius:50%;
  overflow:hidden;border:3px solid #ddd;background:#fff
}
.preview img{width:100%;height:100%;object-fit:cover}

.fab{
  position:fixed;bottom:16px;right:16px;
  width:56px;height:56px;border-radius:50%;
  background:#000;color:#fff;font-size:22px;
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 6px 16px rgba(0,0,0,.3);
  cursor:pointer
}
canvas{display:none}
</style>
</head>

<body>

<header>
  <img src="logo.png" alt="AksharaNama Logo">
  <h1>AksharaNama</h1>
</header>
<small>Privacy-first ‚Ä¢ No data stored</small>

<div class="controls">

<label>Upload Image</label>
<input type="file" accept="image/*" id="imgInput">

<label>Language</label>
<select id="language">
  <option value="te">Telugu</option>
  <option value="en">English</option>
  <option value="ta">Tamil</option>
  <option value="kn">Kannada</option>
  <option value="hi">Hindi</option>
  <option value="sa">Sanskrit</option>
</select>

<label>Font</label>
<select id="fontSelect"></select>

<label>Enter Name</label>
<input type="text" id="nameInput" placeholder="Type name here">

<label>Name Position</label>
<select id="position">
  <option value="bottom">Bottom</option>
  <option value="top">Top</option>
  <option value="left">Left</option>
  <option value="right">Right</option>
</select>

<button id="downloadBtn" disabled>‚¨áÔ∏è Download Image</button>
<button class="secondary" id="resetBtn">üîÑ Reset</button>

</div>

<div class="preview">
  <img id="imgPreview">
</div>

<div id="installFab" class="fab" hidden>‚¨áÔ∏è</div>

<canvas id="canvas" width="1080" height="1080"></canvas>

<script>
const fonts={
  te:["Noto Sans Telugu"],ta:["Noto Sans Tamil"],
  kn:["Noto Sans Kannada"],hi:["Noto Sans Devanagari"],
  sa:["Noto Serif Devanagari"],en:["Arial"]
};

const imgInput=document.getElementById("imgInput");
const imgPreview=document.getElementById("imgPreview");
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
const nameInput=document.getElementById("nameInput");
const fontSelect=document.getElementById("fontSelect");
const language=document.getElementById("language");
const position=document.getElementById("position");
const downloadBtn=document.getElementById("downloadBtn");
const resetBtn=document.getElementById("resetBtn");

function loadFonts(){
  fontSelect.innerHTML="";
  fonts[language.value].forEach(f=>{
    const o=document.createElement("option");
    o.value=f;o.textContent=f;
    fontSelect.appendChild(o);
  });
}
loadFonts();
language.onchange=()=>{loadFonts();drawCanvas();};

imgInput.onchange=()=>{
  const f=imgInput.files[0];
  if(!f)return;
  const r=new FileReader();
  r.onload=()=>{imgPreview.src=r.result;drawCanvas()};
  r.readAsDataURL(f);
};

[nameInput,fontSelect,position].forEach(el=>{
  el.addEventListener("input",drawCanvas);
});

function drawCurved(text,font,top=false){
  if(!text)return;
  ctx.font=font;ctx.fillStyle="#fff";
  ctx.shadowColor="rgba(0,0,0,.6)";ctx.shadowBlur=4;
  const chars=text.split("");
  const r=460;
  const start=top?Math.PI*1.15:Math.PI*0.85;
  const step=Math.PI/(chars.length+2);
  chars.forEach((c,i)=>{
    const a=start+i*step;
    ctx.save();
    ctx.translate(540+r*Math.cos(a),540+r*Math.sin(a));
    ctx.rotate(a+Math.PI/2);
    ctx.fillText(c,0,0);
    ctx.restore();
  });
}

function drawCanvas(){
  if(!imgPreview.src)return;
  const img=new Image();
  img.onload=()=>{
    ctx.clearRect(0,0,1080,1080);
    ctx.save();
    ctx.beginPath();
    ctx.arc(540,540,540,0,Math.PI*2);
    ctx.clip();
    ctx.drawImage(img,0,0,1080,1080);
    ctx.restore();

    ctx.font=`700 64px ${fontSelect.value}`;
    ctx.textAlign="center";ctx.textBaseline="middle";

    if(position.value==="bottom") drawCurved(nameInput.value,ctx.font,false);
    else if(position.value==="top") drawCurved(nameInput.value,ctx.font,true);
    else if(position.value==="left"){ctx.fillText(nameInput.value,160,540)}
    else if(position.value==="right"){ctx.fillText(nameInput.value,920,540)}

    downloadBtn.disabled=false;
  };
  img.src=imgPreview.src;
}

downloadBtn.onclick=()=>{
  const a=document.createElement("a");
  a.download="aksharanama.png";
  a.href=canvas.toDataURL("image/png");
  a.click();
};

resetBtn.onclick=()=>{
  imgInput.value="";
  imgPreview.src="";
  nameInput.value="";
  ctx.clearRect(0,0,1080,1080);
  downloadBtn.disabled=true;
};

let deferredPrompt;
const fab=document.getElementById("installFab");
window.addEventListener("beforeinstallprompt",e=>{
  e.preventDefault();deferredPrompt=e;fab.hidden=false;
});
fab.onclick=async()=>{deferredPrompt.prompt();fab.hidden=true};

if("serviceWorker"in navigator){
  navigator.serviceWorker.register("sw.js");
}
</script>

</body>
</html>
